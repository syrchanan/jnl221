pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 45, vjust = .2, hjust = .1))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 45, vjust = .2, hjust = .01))
source('~/School/Syracuse/Sr Sem 1/JNL 221/data_lit_3.R', echo=TRUE)
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 45, vjust = .2, hjust = -.5))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 45, vjust = .2, hjust = .5))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = .5))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 45, vjust = .8, hjust = .5))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 45, vjust = .1, hjust = .5))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .1, hjust = .5))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
ggplot()+
geom_bar(aes(measure, average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .1, hjust = .5))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .1, hjust = .5))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .1, hjust = .1))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
select(-`Number of Trips`, -`Population Staying at Home`, -`Population Not Staying at Home`) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
select(-`number of trips`, -`population staying at home`, -`population not staying at home`) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>% View()
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>% View()
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))
ordering <- colnames(test)
ordering <- colnames(test)[4:13]
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(measure = factor(measure, levels = ordering)) %>%
ggplot()+
geom_bar(aes(reorder(measure, -average), average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(measure = factor(measure, levels = ordering)) %>%
ggplot()+
geom_bar(aes(measure, average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(measure = factor(measure, levels = ordering)) %>%
ggplot()+
geom_bar(aes(measure, average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
ylab("Number of Trips")+
xlab("")+
ggtitle("Average Number of People Taking Trips of Various Length During COVID-19")
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(measure = gsub("Number of Trips ", "", .),
measure = factor(measure, levels = ordering)) %>%
ggplot()+
geom_bar(aes(measure, average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
ylab("Number of Trips")+
xlab("")+
ggtitle("Average Number of People Taking Trips of Various Length During COVID-19")
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(measure = gsub("Number of Trips ", "", measure),
measure = factor(measure, levels = ordering)) %>%
ggplot()+
geom_bar(aes(measure, average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
ylab("Number of Trips")+
xlab("")+
ggtitle("Average Number of People Taking Trips of Various Length During COVID-19")
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(#measure = gsub("Number of Trips ", "", measure),
measure = factor(measure, levels = ordering)) %>%
ggplot()+
geom_bar(aes(measure, average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
ylab("Number of Trips")+
xlab("")+
ggtitle("Average Number of People Taking Trips of Various Length During COVID-19")
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(#measure = gsub("Number of Trips ", "", measure),
measure = factor(measure, levels = ordering)) %>% View()
ordering <- gsub("Number of Trips ", "", colnames(test)[4:13])
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(measure = gsub("Number of Trips ", "", measure),
measure = factor(measure, levels = ordering)) %>% View()
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(measure = gsub("Number of Trips ", "", measure),
measure = factor(measure, levels = ordering)) %>%
ggplot()+
geom_bar(aes(measure, average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
ylab("Number of Trips")+
xlab("")+
ggtitle("Average Number of People Taking Trips of Various Length During COVID-19")
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(measure = gsub("Number of Trips ", "", measure),
measure = factor(measure, levels = ordering)) %>%
ggplot()+
geom_bar(aes(measure, average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
ylab("Average Number of People")+
xlab("Number of Trips")+
ggtitle("Average Number of People Taking Trips of Various Length During COVID-19")
ggsave("onondaga_trips.jpg", device = "jpg")
ev_ny_clean %>%
mutate(rebate_usd = as.numeric(rebate_usd)) %>%
group_by(county) %>%
summarise(rebate = sum(rebate_usd)) %>%
arrange(desc(rebate)) %>%
slice(1:10) %>%
mutate(county = str_to_title(county)) %>%
ggplot()+
geom_bar(aes(reorder(county,-rebate), rebate, fill=factor(ifelse(county=="Onondaga","Onondaga","Other"))), stat = "identity", show.legend = FALSE)+
scale_fill_manual(name = "County", values=c("red","grey50")) +
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
theme_minimal() +
xlab("Counties") +
ylab("Total Rebates Given ($)") +
ggtitle("Total Electric Vehicle Rebates Distributed By County in NY State, 2017-2021")
ev_ny_clean %>%
mutate(submit_date = month(submit_date),
year_ghg_redux_mtco2e = as.numeric(year_ghg_redux_mtco2e),
year_petrol_redux_gallons = as.numeric(year_petrol_redux_gallons),
rebate_usd = as.numeric(rebate_usd)) %>%
group_by(submit_date, county) %>%
summarise(avg_rebate = mean(rebate_usd)) %>%
ungroup() %>%
left_join(.,date_ref, by = c("submit_date" = "month_number")) %>%
mutate(county = str_to_title(county)) %>%
ggplot() +
geom_tile(aes(county, month_name, fill = avg_rebate))+
scale_fill_viridis_c()+
theme(axis.text.x = element_text(angle = 90, vjust = .2, hjust = 1))+
xlab("County")+
ylab("Month")+
ggtitle("Average Rebate Paid by Month in NY State, 2017-2021")+
labs(fill = "Average Rebate")
plot_grid(trip_2019, trip_2020, trip_2021,
ncol = 3, nrow = 1,
labels = c("2019", "2020", "2021"))
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(measure = gsub("Number of Trips ", "", measure),
measure = factor(measure, levels = ordering)) %>%
ggplot()+
geom_bar(aes(measure, average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
ylab("Average Number of People")+
xlab("Number of Trips")+
ggtitle("Average Number of People Taking Trips of Various Length During COVID-19 in Onondaga County")
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(measure = gsub("Number of Trips ", "", measure),
measure = factor(measure, levels = ordering)) %>%
ggplot()+
geom_bar(aes(measure, average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
ylab("Average Number of Trips")+
xlab("Number of Trips")+
ggtitle("Average Trip Taken of Various Length During COVID-19 in Onondaga County")
ggsave("onondaga_trips.jpg", device = "jpg")
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(measure = gsub("Number of Trips ", "", measure),
measure = factor(measure, levels = ordering)) %>%
ggplot()+
geom_bar(aes(measure, average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
ylab("Average Number of Trips")+
xlab("Number of Trips")+
ggtitle("Average Trips Taken of Various Length During COVID-19 in Onondaga County")
ggsave("onondaga_trips.jpg", device = "jpg")
test %>%
pivot_longer(
cols = everything(),
names_to = "measure",
values_to = "average"
) %>%
slice(4:13) %>%
mutate(measure = gsub("Number of Trips ", "", measure),
measure = factor(measure, levels = ordering)) %>%
ggplot()+
geom_bar(aes(measure, average), stat = "identity")+
theme(axis.text.x = element_text(angle = 15, vjust = .8, hjust = .5))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
ylab("Occurrences")+
xlab("Number of Trips")+
ggtitle("Number of Trips Taken of Various Length During COVID-19 in Onondaga County")
ggsave("onondaga_trips.jpg", device = "jpg")
library(pacman)
library(tidyverse)
library(lubridate)
trips <- read_csv("Trips_by_Distance.csv", col_types = cols(.default = "c", Date = "D")) #parsing error, may be causing problem with NA values?
View(trips)
library(tidyverse)
library(lubridate)
setwd("~/School/Syracuse/Sr Sem 1/JNL 221")
ev_ny <- read_csv("NYSERDA_Electric_Vehicle_Drive_Clean_Rebate_Data__Beginning_2017.csv")
setwd("C:/Users/cdawg/git_repos/jnl221/weeks_1-6")
setwd("C:/Users/cdawg/git_repos/jnl221/weeks_1-6")
ev_ny <- read_csv("NYSERDA_Electric_Vehicle_Drive_Clean_Rebate_Data__Beginning_2017.csv")
ev_ny %>%
select(-1) %>%
mutate_all(tolower) %>%
rename_all(tolower) %>%
rename("submit_date" = 1,
"ev_type" = 6,
"trans_type" = 7,
"year_ghg_redux_mtco2e" = 8,
"year_petrol_redux_gallons" = 9,
"rebate_usd" = 10) %>%
mutate(submit_date = mdy(submit_date)) -> ev_ny_clean
View(ev_ny_clean)
ev_ny_clean %>%
table(is.na)
ev_ny_clean %>%
lapply(is.na)
ev_ny_clean %>%
lapply(table(is.na))
ev_ny_clean %>%
table(lapply(is.na))
ev_ny_clean %>%
table(lapply(.,is.na))
ev_ny_clean %>%
lapply(is.na) %>%
table()
ev_ny_clean %>%
lapply(is.na) %>%
sum()
ev_ny_clean %>%
lapply(is.na) %>%
count(TRUE)
ev_ny_clean %>%
lapply(is.na) %>%
View()
table(item)
ev_ny_clean %>%
lapply(is.na) -> list_na
for (item in list_na) {
table(item)
}
table(list_na[1])
table(list_na[2])
table(list_na[3])
table(list_na[4])
table(list_na[5])
table(list_na[6])
table(list_na[7])
table(list_na[8])
table(list_na[9])
table(list_na[10])
ev_ny_clean %>%
filter(!is.na(4),
!is.na(7),
!is.na(10)) %>% View()
ev_ny_clean %>%
filter(!is.na(4),
!is.na(7),
!is.na(10)) %>% View()
ev_ny_clean %>%
filter(!is.na(4) &
!is.na(7) &
!is.na(10)) %>% View()
ev_ny_clean %>%
filter(!is.na(.[4]) &
!is.na(.[7]) &
!is.na(.[10])) %>% View()
ev_ny_clean %>%
filter(!is.na(.[4]) &
!is.na(.[7]) &
!is.na(.[10])) -> ev_no_na
View(ev_no_na)
write.csv(ev_no_na, file = "ev_rebate_clean.csv")
